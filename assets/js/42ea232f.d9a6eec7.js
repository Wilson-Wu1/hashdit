"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7970],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},h="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=c(a),u=i,m=h["".concat(l,".").concat(u)]||h[u]||d[u]||r;return a?n.createElement(m,o(o({ref:t},p),{},{components:a})):n.createElement(m,o({ref:t},p))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[h]="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},56515:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var n=a(87462),i=(a(67294),a(3905));const r={slug:"monthly-incident-sharing-mar-2024",title:"Monthly Incident Sharing - March 2024",authors:["Sebastian"],tags:["Mar","Incidents","Sharing",2024]},o=void 0,s={permalink:"/hashdit/blog/monthly-incident-sharing-mar-2024",source:"@site/blog/2024-04-09/2024-04-09.md",title:"Monthly Incident Sharing - March 2024",description:"Introduction",date:"2024-04-09T00:00:00.000Z",formattedDate:"April 9, 2024",tags:[{label:"Mar",permalink:"/hashdit/blog/tags/mar"},{label:"Incidents",permalink:"/hashdit/blog/tags/incidents"},{label:"Sharing",permalink:"/hashdit/blog/tags/sharing"},{label:"2024",permalink:"/hashdit/blog/tags/2024"}],readingTime:6.74,hasTruncateMarker:!1,authors:[{name:"Sebastian Lim",title:"SCS@HashDit",url:"https://github.com/slim115",imageURL:"https://github.com/slim115.png",key:"Sebastian"}],frontMatter:{slug:"monthly-incident-sharing-mar-2024",title:"Monthly Incident Sharing - March 2024",authors:["Sebastian"],tags:["Mar","Incidents","Sharing","2024"]},prevItem:{title:"Monthly Incident Sharing - April 2024",permalink:"/hashdit/blog/monthly-incident-sharing-apr-2024"},nextItem:{title:"Meme Education Guide",permalink:"/hashdit/blog/meme-education-guide"}},l={authorsImageUrls:[void 0]},c=[{value:"Introduction",id:"introduction",level:2},{value:"Top 5 DApps incidents",id:"top-5-dapps-incidents",level:2},{value:"Munchables - $62.5m - Insider Attack",id:"munchables---625m---insider-attack",level:3},{value:"PrismaFi - $12m - Lack of Validation",id:"prismafi---12m---lack-of-validation",level:3},{value:"WooFi - $8.7m - Price Manipulation",id:"woofi---87m---price-manipulation",level:3},{value:"SSS_HQ - $4.8m - Function wrongly implemented",id:"sss_hq---48m---function-wrongly-implemented",level:3},{value:"Unizen - $2.1m - Lack of Validation",id:"unizen---21m---lack-of-validation",level:3},{value:"Key lessons for developers",id:"key-lessons-for-developers",level:2}],p={toc:c};function h(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"justify"},(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"In this monthly series, HashDit is sharing the monthly security incidents in the crypto space and what we can learn from them. For this Mar 2024 edition, the total losses mounted up to $146 million, showing a 50% decrease compared to March 2023. "),(0,i.kt)("p",null,"Of which, they are split across 2 sections: DApps ($114m) and Phishing ($32m)."),(0,i.kt)("p",null,"In this sharing, we focus on the DApps incidents. Below are the top 5 DApps incidents that DApp Developers should pay attention to."),(0,i.kt)("h2",{id:"top-5-dapps-incidents"},"Top 5 DApps incidents"),(0,i.kt)("h3",{id:"munchables---625m---insider-attack"},"Munchables - $62.5m - Insider Attack"),(0,i.kt)("p",null,"Munchables is a GameFi and NFT protocol. In this attack, it was confirmed to be an Insider Attack where a rogue employee was malicious, gaining access to a privileged account. After malicious logic was introduced in a proxy contract upgrade, 62M funds were transferred out by the attacker. Thankfully, after some negotiation and investigation, the funds were eventually returned."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": Malicious developer was hired and suspected to be linked to DPRK, and had bad intentions right from the start. It was found that the malicious logic was already introduced during deployment and the bad actor used manual manipulation of the getLocked storage slot to assign himself an enormous Ether balance in the contract, so that his locked amount would bypass the withdrawal checks."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0x9a7e4d16ed15b0367b8ad677eaf1db6a2a54663610696d69e1b4aa1a08f55c95"},"Hack tx")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0xea1d9c0d8de4280b538b6fe6dbc3636602075184651dfeb837cb03f8a19ffc4f"},"Malicious contract upgrade")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code snippet"),":"),(0,i.kt)("p",null,"Unverified contract"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-1",src:a(51355).Z,width:"2472",height:"1166"}),"\n",(0,i.kt)("img",{alt:"IMG-2",src:a(52400).Z,width:"1548",height:"1480"})),(0,i.kt)("h3",{id:"prismafi---12m---lack-of-validation"},"PrismaFi - $12m - Lack of Validation"),(0,i.kt)("p",null,"PrismaFi is a DeFi protocol, which is known as a non-custodial and decentralized Ethereum LST & LRT backed stablecoins. In this attack, the hackers bypassed the migrate function and called the flash loan directly with carefully crafted input data."),(0,i.kt)("p",null,"The flash loan's callback function, onFlashloan(), was called. The lack of proper checks allowed the hackers to close a trove owner's Trove and immediately reopen it within the same TroveManager. The transaction caused the owner's position to be closed and reopened, resulting in the trove owner having a new position with the same debt but less collateral and the difference in collateral sitting in the zap contract."),(0,i.kt)("p",null,"The hackers then opened a new Trove and used the MigrateTroveZap contract to migrate it, effectively using the remaining collateral for their own Trove.\nFinally, the hackers closed their Trove and took the profits."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The root cause of the vulnerability was twofold:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"By directly calling the onFlashloan() function, the user could manipulate other trove managers positions."),(0,i.kt)("li",{parentName:"ol"},"The contract allowed for a mismatch between the collateral in the initial position and the collateral in the new position, with the difference being susceptible to being taken.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x00c503b595946bccaea3d58025b5f9b3726177bbdc9674e634244135282116c7"},"Hack tx 1")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0xce3cdc7c29eb7dfc565f5d99034789e80c1cd3278adafa26af6f3d21c8412c59"},"Hack tx 2")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0x0e38dd693ddbc2f62282932f36a4b8de75f8ea1da530532af26698b4eda9a110"},"Hack tx 3")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code snippet"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-3",src:a(38609).Z,width:"2434",height:"1276"})),(0,i.kt)("h3",{id:"woofi---87m---price-manipulation"},"WooFi - $8.7m - Price Manipulation"),(0,i.kt)("p",null,"WooFi is a DeFi protocol which operates as a DEX, allowing users to swap tokens. In this attack, the attacker was able to compromise the WooPPV2 contract on Arbitrum. The exploit consisted of a sequence of flash loans that took advantage of low liquidity to manipulate the price of WOO in order to repay the flash loans at a cheaper price."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": There were 2 configuration issues. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"A previously unidentified error resulted in the price being adjusted far outside of the expected range ($0.00000009) "),(0,i.kt)("li",{parentName:"ol"},"The fallback check, normally executed against Chain Link, didn\u2019t cover the WOO token price.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://arbiscan.io/tx/0x40e1b8c78083fc666cb7598efcecd0ae0af313fc41441386e4db716c2808ce07"},"Hack tx 1")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://arbiscan.io/tx/0xe80a16678b5008d5be1484ec6e9e77dc6307632030553405863ffb38c1f94266"},"Hack tx 2")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code snippet"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-4",src:a(51356).Z,width:"2446",height:"1288"}),"\n",(0,i.kt)("img",{alt:"IMG-5",src:a(61310).Z,width:"2500",height:"1122"})),(0,i.kt)("h3",{id:"sss_hq---48m---function-wrongly-implemented"},"SSS_HQ - $4.8m - Function wrongly implemented"),(0,i.kt)("p",null,"SSS_HQ or Super Sushi Samurai is a GameFi platform on Blast chain. In this attack, thankfully a White Hat was able to spot the bug before any malicious actor, where he increased his own balance by repeatedly transferring to himself. He subsequently swapped these tokens in the liquidity pool and protected the liquidity of ~$4.8m."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": The tax transfer logic is wrongly implemented in the _update method of the SSS.sol code. The _balances","[to]"," value is incremented before the _balances","[from]"," value is updated (done within the _postCheck method), seen in the first picture. As such, the balance of the to address uses the stale value i.e original balance, seen in the second picture. This is summed with the amount variable, stored in the toBalance variable and subsequently overwriting the _balances","[from]"," in the last statement, almost doubling the sender\u2019s balance."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://blastscan.io/tx/0x62e6b906bb5aafdc57c72cd13e20a18d2de3a4a757cd2f24fde6003ce5c9f2c6"},"White-hat Hack tx")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code snippet"),":"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-6",src:a(48345).Z,width:"2450",height:"1296"}),"\n",(0,i.kt)("img",{alt:"IMG-7",src:a(79565).Z,width:"2482",height:"580"})),(0,i.kt)("h3",{id:"unizen---21m---lack-of-validation"},"Unizen - $2.1m - Lack of Validation"),(0,i.kt)("p",null,"Unizen is a DeFi protocol which operates as a DEX across multiple chains. In this instance, the attack happened on Ethereum, just 5 hours after the victim proxy was upgraded to a vulnerable logic contract. The vulnerable contract introduced a function 0x1ef29a02 which allowed arbitrary calldata to be sent. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Root cause"),": Lack of validation in a Swap related function (which allowed arbitrary transferFrom calls, specifying the From, To and Amount parameters). As such, victims that have approved their funds to this contract will be affected."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Onchain information"),":"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://etherscan.io/tx/0xc12a4155c2c90707138e4aef8883c8f724371145823e2f661f19b93e5b3a9d6e"},"Hack tx")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code snippet"),":\nUnverified contract"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IMG-8",src:a(35319).Z,width:"2066",height:"164"}),"\n",(0,i.kt)("img",{alt:"IMG-9",src:a(53008).Z,width:"576",height:"146"}),"\n",(0,i.kt)("img",{alt:"IMG-10",src:a(71900).Z,width:"2764",height:"212"})),(0,i.kt)("h2",{id:"key-lessons-for-developers"},"Key lessons for developers"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In light of potential insider compromises, it's crucial to apply thorough background checks for new employees. Specifically, keep an eye out for potential red flags including:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Preference for certain platforms:")," Malicious developers seem to favor using Github, often impersonating user profiles such as SuperTalentedDev726 or CryptoKnight415.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use of numbers:")," Both email addresses and Github usernames often contain numerical sequences. It's suspected they use this as a method for tracking the identities they impersonate.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Asian identities:")," There's a tendency toward choosing Japanese (and possibly Korean) identities, often claiming prior education in Japan.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Prominent educational background:")," The falsified credentials often include elite universities in Japan, Hong Kong, and Singapore. Such institutions may include Singapore State University, Nanyang Technological University, University of Hong Kong or Hong Kong University of Science and Technology.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Codebase theft:")," While not always the case, these imposters often steal existing projects from GitHub and recondition the commit messages to reflect their assumed usernames.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Multiple applications:")," They tend to apply repeatedly for the same job, resorting to multiple email addresses for their submissions.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Premature expertise:")," They often claim experience in Solidity/EVM too early (such as in 2015), which is an unlikely scenario giving the nascent state of blockchain technology at the time.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Input validation is a crucial process - it's essential to verify all potential user inputs, especially when these inputs affect changes to the state of the system. This holds particularly true in the below scenarios:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Calldata Parameters:")," Given that attackers have the ability to craft any data, extra validation steps must be in place for calldata parameters.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"User Approvals:")," During the process where the protocol contract manages users' approvals, meticulous input checks are paramount to prevent potential malicious activities.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To guard against price manipulation, it's essential to ensure that updated prices cannot be influenced to reflect unexpected values. Oracles, both on-chain and off-chain types, can be employed by developers. Here's how:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Set Boundaries:")," Implementing limits can block prices from being abruptly manipulated to an impossible value, regardless of the oracle type in use.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Fallback Oracle:")," Integrate a secondary oracle as a fallback measure. This ensures that if the initial oracle fails, there is a backup in place to verify the consistency of prices. By doing so, it ensures continuous, reliable price feeds, and safeguards against single point of failure.")))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Ensuring that the deployed function aligns with the intended objective is a critical requirement, especially for high-stakes operations such as accounting. This assurance can be achieved through:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Thorough Testing:")," Execute comprehensive fuzz testing and edge case analysis. This doesn't solely ensure correct function logic, it also helps to identify potential flaws and security vulnerabilities that might otherwise be overlooked.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use Trusted Templates:")," Consider using trusted codebases, such as Openzeppelin, as a foundation for your code. These established libraries have been vetted extensively by the developer community, reducing the likelihood of introduction of unexpected bugs or issues."))))),(0,i.kt)("p",null,"Feel free to contact us at ",(0,i.kt)("a",{parentName:"p",href:"mailto:support@hashdit.io"},"support@hashdit.io")," for any support needed! Stay safe!"),(0,i.kt)("p",null,"*Unverified contracts screenshots courtesy of Dedaub\u2019s decompiler!")))}h.isMDXComponent=!0},51355:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/1-21ba244362c94bac7527ea374c136625.png"},71900:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/10-8bca9882db94438e55423645b10e359f.png"},52400:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/2-e496156fb5b1ac071ec742d2a03f1ff2.png"},38609:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/3-cbabf4825b46c1c9e8c20b58a1f94190.png"},51356:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/4-9678ce02d5bf2abb832d9be16732cda9.png"},61310:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/5-89d68fb5f280af92d3312ae8bb18efda.png"},48345:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/6-0ba50f8dd2cc93d2d34703751344e355.png"},79565:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/7-a6035a7c2c90673517a3ee25d667449e.png"},35319:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/8-931334844f2e49da8fee7bc0e18989e6.png"},53008:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/9-15da38e5b70cc0081ac666cdf6c3c690.png"}}]);